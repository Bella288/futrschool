<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Assignment Dashboard | GradeLine</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="icon" type="image/png" href="/assets/icons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg" />
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="F" />
  <link rel="manifest" href="/assets/icons/site.webmanifest" />
  <style>
    /* About button styles */
    .about-button {
      position: fixed;
      top: 15px;
      right: 15px;
      width: 32px;
      height: 32px;
      cursor: pointer;
      transition: transform 0.2s;
      z-index: 1001;
    }
    .about-button:hover {
      transform: scale(1.1);
    }
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1002;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.6);
      overflow: auto;
    }
    .modal-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 25px;
      border-radius: 10px;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      position: relative;
    }
    .close-button {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      position: absolute;
      right: 15px;
      top: 10px;
    }
    .close-button:hover,
    .close-button:focus {
      color: black;
      text-decoration: none;
    }
    
    /* Dyslexia-friendly font option */
    .dyslexia-mode {
        font-family: "OpenDyslexic", Arial, sans-serif;
        letter-spacing: 0.05em;
        line-height: 1.6;
    }
    
    /* Skip link styling */
    .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #000;
        color: white;
        padding: 8px;
        z-index: 10000;
        transition: top 0.3s;
    }
    
    .skip-link:focus {
        top: 0;
    }
    
    /* Form accessibility improvements */
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    
    /* Focus styles for better keyboard navigation */
    button:focus,
    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid #0066cc;
      outline-offset: 2px;
    }
    
    /* Dialog styles */
    .status-dialog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 20px;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 1003;
      display: none;
    }
    
    .status-dialog[open] {
      display: block;
    }
    
    .dialog-content {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .dialog-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-end;
    }
    
    .dialog-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .dialog-btn.missing {
      background-color: #fff3cd;
      color: #856404;
    }
    
    .dialog-btn.not-graded {
      background-color: #e2e3e5;
      color: #383d41;
    }
    
    .dialog-btn.cancel {
      background-color: #f8f9fa;
      color: #212529;
    }
    
    /* Dyslexia toggle button */
    #dyslexia-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 10px;
      background: #f0f0f0;
      border: 1px solid #ccc;
      border-radius: 4px;
      cursor: pointer;
      z-index: 1000;
    }
    
    /* Comment dialog styles */
    .comment-dialog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      z-index: 1004;
      width: 90%;
      max-width: 500px;
      display: none;
      padding: 0;
      overflow: hidden;
    }
    
    .comment-dialog[open] {
      display: block;
    }
    
    .comment-header {
      background: #f5f5f5;
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .comment-title {
      margin: 0;
      font-size: 1.2rem;
      color: #333;
    }
    
    .comment-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #777;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    .comment-close:hover {
      background: #e0e0e0;
      color: #333;
    }
    
    .comment-body {
      padding: 20px;
    }
    
    .comment-text {
      margin: 0 0 15px 0;
      line-height: 1.5;
      color: #444;
    }
    
    .comment-date {
      font-size: 0.85rem;
      color: #777;
      text-align: right;
    }
    
    .comment-dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1003;
      display: none;
    }
    
    .comment-dialog-overlay[open] {
      display: block;
    }
    
    /* Comment button in assignment items */
    .comment-btn {
      background: #e8f4fc;
      border: 1px solid #c2e0f5;
      border-radius: 4px;
      padding: 4px 8px;
      font-size: 0.85rem;
      color: #0066cc;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-left: 8px;
    }
    
    .comment-btn:hover {
      background: #d1e9fa;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <img src="https://raw.githubusercontent.com/Bella288/F1View/main/images/about_ico.png" 
       alt="About GradeLine" class="about-button" title="About the creator and page" id="aboutBtn">
  
  <nav class="navbar" aria-label="Main navigation">
    <a href="index.html">üè´ Class Setup</a>
    <a href="dashboard.html" class="active" aria-current="page">üìã Dashboard</a>
    <a href="schedule.html">‚è∞ Schedule</a>
    <a href="overview.html">üìä Overview</a>
    <a href="quicklinks.html">üîó Quick Links</a>
    <a href="settings.html">‚öôÔ∏è Settings</a>
    <a href="policies.html">üìë Policies</a>
  </nav>
  
  <button id="dyslexia-toggle" aria-pressed="false">Dyslexia-friendly font</button>
  
  <main id="main-content">
    <header>
      <h1>üìö Assignment Dashboard</h1>
    </header>

    <!-- About Modal -->
    <div id="aboutModal" class="modal" role="dialog" aria-labelledby="modal-title" aria-modal="true">
      <div class="modal-content">
        <button class="close-button" aria-label="Close dialog">&times;</button>
        <h2 id="modal-title">About GradeLine</h2>
        <p><strong>Creator:</strong> Bella Lawrence</p>
        <p><strong>YouTube:</strong> <a href="https://youtube.com/@SerialDesignationN-BL" target="_blank" rel="noopener noreferrer">youtube.com/@SerialDesignationN-BL</a></p>
        <p><strong>Instagram:</strong> @q_law09</p>
        <p><strong>Email:</strong> <a href="mailto:barbar288.2021@gmail.com">barbar288.2021@gmail.com</a></p>
        <p><strong>Source Code:</strong> <a href="https://github.com/Bella288/futrschool" target="_blank" rel="noopener noreferrer">github.com/Bella288/futrschool</a></p>
        <hr>
        <p><strong>Why I made it:</strong> To help me and others keep track of their grades and schedules.</p>
        <p><strong>Other use cases:</strong> Teachers can track overall average grade by class</p>
        <p><strong>Features:</strong> Schedule view, classes and assignments, weighted categories, auto-grade calculation, and more</p>
        <hr>
        <p><strong>My Bio:</strong> Hey! I'm Bella Lawrence, a developer in the wonderful city of Fort Wayne, Indiana. I live with my two cats, Hermione and Barley, my dog, Pebbles, and my rabbit, Buttercup.</p>
      </div>
    </div>

    <section class="class-selection" aria-labelledby="class-select-label">
      <label for="class-select" id="class-select-label">Select Class:</label>
      <select id="class-select" aria-describedby="class-select-desc"></select>
      <div id="class-select-desc" class="visually-hidden">Select a class to view its assignments</div>
    </section>

    <section class="grade-display" aria-labelledby="grade-heading">
      <h2 id="grade-heading">üìä Grade: <span id="gpa-display">N/A</span></h2>
    </section>

    <section class="assignment-form" aria-labelledby="add-assignment-heading">
      <form id="add-assignment-form">
        <h2 id="add-assignment-heading">Add New Assignment</h2>
        
        <div class="form-group">
          <label for="assignment-title">Assignment Title</label>
          <input type="text" id="assignment-title" name="assignment-title" placeholder="Enter assignment title" required aria-required="true" />
        </div>
        
        <div class="form-group">
          <label for="assignment-link">Assignment Link (Optional)</label>
          <input type="url" id="assignment-link" name="assignment-link" placeholder="https://example.com" aria-describedby="link-desc" />
          <div id="link-desc" class="visually-hidden">Optional link to the assignment</div>
        </div>
        
        <div class="form-group">
          <label for="due-date">Due Date</label>
          <input type="date" id="due-date" name="due-date" required aria-required="true" />
        </div>
        
        <div class="form-group">
          <label for="due-time">Due Time (Optional)</label>
          <input type="time" id="due-time" name="due-time" placeholder="Time" aria-describedby="time-desc" />
          <div id="time-desc" class="visually-hidden">Optional time, defaults to 11:59 PM if not specified</div>
        </div>
        
        <div class="form-group">
          <label for="category">Category</label>
          <select id="category" name="category" required aria-required="true"></select>
        </div>
        
        <div class="form-group">
          <label for="points">Points</label>
          <input type="number" id="points" name="points" placeholder="Enter points" required aria-required="true" min="0" step="0.1" />
        </div>
        
        <button type="submit">‚ûï Add Assignment</button>
      </form>
    </section>

    <section class="search-section" aria-labelledby="search-heading">
      <h2 id="search-heading">üîç Search Assignments</h2>
      <div class="search-controls">
        <label for="search-input" class="visually-hidden">Search assignments</label>
        <input type="text" id="search-input" placeholder="Search by title, category, or due date..." aria-describedby="search-desc" />
        <div id="search-desc" class="visually-hidden">Type to search through your assignments</div>
        <button id="search-btn" class="search-button">Search</button>
        <button id="clear-search-btn" class="search-button">Clear</button>
      </div>
    </section>

    <section class="sort-section" aria-labelledby="sort-heading">
      <h2 id="sort-heading">üîÄ Sort Assignments</h2>
      <div class="sort-controls">
        <label for="sort-by" class="visually-hidden">Sort assignments by</label>
        <select id="sort-by" aria-describedby="sort-desc">
          <option value="due-asc">Due Date (Oldest First)</option>
          <option value="due-desc">Due Date (Newest First)</option>
          <option value="title-asc">Title (A-Z)</option>
          <option value="title-desc">Title (Z-A)</option>
          <option value="points-asc">Points (Low to High)</option>
          <option value="points-desc">Points (High to Low)</option>
          <option value="status">Completion Status (Ungraded First)</option>
        </select>
        <div id="sort-desc" class="visually-hidden">Select how to sort your assignments</div>
      </div>
    </section>

    <section class="assignments-list" aria-labelledby="assignments-heading">
      <h2 id="assignments-heading">üìã Assignments</h2>
      <div id="assignment-list" role="list" aria-label="List of assignments"></div>
    </section>
  </main>
  
  <!-- Comment Dialog -->
  <div id="comment-dialog-overlay" class="comment-dialog-overlay"></div>
  <div id="comment-dialog" class="comment-dialog" role="dialog" aria-labelledby="comment-dialog-title">
    <div class="comment-header">
      <h3 id="comment-dialog-title" class="comment-title">Assignment Comment</h3>
      <button class="comment-close" aria-label="Close comment dialog">√ó</button>
    </div>
    <div class="comment-body">
      <p id="comment-text" class="comment-text"></p>
      <div id="comment-date" class="comment-date"></div>
    </div>
  </div>
  
  <script src="js/assignments.js"></script>
  <script src="js/grades.js"></script>
  <script>
    // Modal functionality
    const modal = document.getElementById("aboutModal");
    const btn = document.getElementById("aboutBtn");
    const span = document.getElementsByClassName("close-button")[0];
    const dyslexiaToggle = document.getElementById("dyslexia-toggle");
    
    // Comment dialog elements
    const commentDialog = document.getElementById("comment-dialog");
    const commentOverlay = document.getElementById("comment-dialog-overlay");
    const commentCloseBtn = commentDialog.querySelector(".comment-close");
    const commentText = document.getElementById("comment-text");
    const commentDate = document.getElementById("comment-date");
    const commentDialogTitle = document.getElementById("comment-dialog-title");
    
    // Load OpenDyslexic font if needed
    if (!sessionStorage.getItem('dyslexiaFontLoaded')) {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'https://cdn.jsdelivr.net/npm/open-dyslexic@1.0.3/webfont.css';
      document.head.appendChild(link);
      sessionStorage.setItem('dyslexiaFontLoaded', 'true');
    }
    
    // Toggle dyslexia-friendly mode
    dyslexiaToggle.addEventListener('click', function() {
      document.body.classList.toggle('dyslexia-mode');
      this.setAttribute('aria-pressed', 
        this.getAttribute('aria-pressed') === 'true' ? 'false' : 'true');
    });
    
    // Modal functions
    function openModal() {
      modal.style.display = "block";
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      // Focus on close button when modal opens
      setTimeout(() => span.focus(), 100);
    }
    
    function closeModal() {
      modal.style.display = "none";
      modal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = 'auto';
      // Return focus to the button that opened the modal
      btn.focus();
    }
    
    // Comment dialog functions
    function showCommentDialog(title, text, date) {
      commentDialogTitle.textContent = `Comment: ${title}`;
      commentText.textContent = text || "No comment provided.";
      commentDate.textContent = date ? `Added on: ${date}` : "";
      
      commentDialog.setAttribute('open', 'true');
      commentOverlay.setAttribute('open', 'true');
      
      // Focus on close button when dialog opens
      setTimeout(() => commentCloseBtn.focus(), 100);
    }
    
    function closeCommentDialog() {
      commentDialog.removeAttribute('open');
      commentOverlay.removeAttribute('open');
    }
    
    // Global function to show comment (called from assignments.js)
    window.showAssignmentComment = function(assignmentTitle, comment, date) {
      showCommentDialog(assignmentTitle, comment, date);
    };
    
    // Event listeners
    btn.onclick = openModal;
    span.onclick = closeModal;
    commentCloseBtn.onclick = closeCommentDialog;
    commentOverlay.onclick = closeCommentDialog;
    
    // Close modals with Escape key
    function handleEscapeKey(e) {
      if (e.key === 'Escape') {
        if (commentDialog.hasAttribute('open')) {
          closeCommentDialog();
        } else if (modal.style.display === 'block') {
          closeModal();
        }
      }
    }
    
    document.addEventListener('keydown', handleEscapeKey);
    
    window.addEventListener('click', function(event) {
      if (event.target == modal) {
        closeModal();
      }
    });
    
    // Trap focus inside modals when open
    function trapFocus(element) {
      element.addEventListener('keydown', function(e) {
        if (e.key === 'Tab') {
          const focusableElements = element.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
          const firstElement = focusableElements[0];
          const lastElement = focusableElements[focusableElements.length - 1];
          
          if (e.shiftKey) {
            if (document.activeElement === firstElement) {
              lastElement.focus();
              e.preventDefault();
            }
          } else {
            if (document.activeElement === lastElement) {
              firstElement.focus();
              e.preventDefault();
            }
          }
        }
      });
    }
    
    trapFocus(modal);
    trapFocus(commentDialog);
  </script>
  
  <dialog id="status-dialog" class="status-dialog" aria-labelledby="dialog-title">
    <div class="dialog-content">
      <h3 id="dialog-title">Assignment Status</h3>
      <p id="dialog-message"></p>
      <div class="dialog-buttons">
        <button id="missing-btn" class="dialog-btn missing">‚ö†Ô∏è Mark as Missing</button>
        <button id="not-graded-btn" class="dialog-btn not-graded">‚åõ Not Graded Yet</button>
        <button id="cancel-status-btn" class="dialog-btn cancel">‚ùå Cancel</button>
      </div>
    </div>
  </dialog>
</body>
</html>
